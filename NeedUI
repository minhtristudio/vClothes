-- vClothes UI Library v2.0 - Enhanced Edition
-- Tạo bởi Assistant - Nâng cấp giao diện và tính năng

local vClothesUI = {}

-- Services
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Tween Info
local tweenInfo = TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.Out)
local fastTween = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)

-- Enhanced Color Scheme
local colors = {
    background = Color3.fromRGB(18, 18, 22),
    backgroundSecondary = Color3.fromRGB(22, 22, 26),
    sidebar = Color3.fromRGB(16, 16, 20),
    accent = Color3.fromRGB(88, 101, 242),
    accentHover = Color3.fromRGB(98, 111, 252),
    text = Color3.fromRGB(255, 255, 255),
    textSecondary = Color3.fromRGB(185, 187, 190),
    textDim = Color3.fromRGB(142, 146, 151),
    hover = Color3.fromRGB(35, 35, 40),
    hoverLight = Color3.fromRGB(45, 45, 50),
    border = Color3.fromRGB(55, 55, 60),
    success = Color3.fromRGB(87, 242, 135),
    warning = Color3.fromRGB(255, 202, 40),
    error = Color3.fromRGB(237, 66, 69),
    shadow = Color3.fromRGB(0, 0, 0)
}

function vClothesUI:CreateWindow(title, config)
    config = config or {}
    local window = {}
    window.tabs = {}
    window.activeTab = nil
    window.minimized = false
    window.toggleBoxContainers = {}
    
    -- Tạo ScreenGui
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "vClothesUI_v2"
    screenGui.Parent = playerGui
    screenGui.ResetOnSpawn = false
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    
    -- Main Container với shadow
    local shadowFrame = Instance.new("Frame")
    shadowFrame.Name = "ShadowFrame"
    shadowFrame.Parent = screenGui
    shadowFrame.Size = UDim2.new(0, 570, 0, 420)
    shadowFrame.Position = UDim2.new(0.5, -285, 0.5, -210)
    shadowFrame.BackgroundColor3 = colors.shadow
    shadowFrame.BackgroundTransparency = 0.7
    shadowFrame.BorderSizePixel = 0
    shadowFrame.ZIndex = 1
    
    local shadowCorner = Instance.new("UICorner")
    shadowCorner.CornerRadius = UDim.new(0, 12)
    shadowCorner.Parent = shadowFrame
    
    -- Main Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Parent = screenGui
    mainFrame.Size = UDim2.new(0, 560, 0, 410)
    mainFrame.Position = UDim2.new(0.5, -280, 0.5, -205)
    mainFrame.BackgroundColor3 = colors.background
    mainFrame.BorderSizePixel = 0
    mainFrame.Active = true
    mainFrame.Draggable = true
    mainFrame.ZIndex = 2
    
    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 10)
    mainCorner.Parent = mainFrame
    
    -- Gradient overlay
    local gradient = Instance.new("UIGradient")
    gradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(25, 25, 30)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(18, 18, 22))
    })
    gradient.Rotation = 45
    gradient.Parent = mainFrame
    
    -- Title Bar với nút minimize
    local titleBar = Instance.new("Frame")
    titleBar.Name = "TitleBar"
    titleBar.Parent = mainFrame
    titleBar.Size = UDim2.new(1, 0, 0, 40)
    titleBar.BackgroundColor3 = colors.backgroundSecondary
    titleBar.BorderSizePixel = 0
    titleBar.ZIndex = 3
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 10)
    titleCorner.Parent = titleBar
    
    local titleFix = Instance.new("Frame")
    titleFix.Parent = titleBar
    titleFix.Size = UDim2.new(1, 0, 0, 10)
    titleFix.Position = UDim2.new(0, 0, 1, -10)
    titleFix.BackgroundColor3 = colors.backgroundSecondary
    titleFix.BorderSizePixel = 0
    titleFix.ZIndex = 3
    
    -- Logo/Icon
    local logoFrame = Instance.new("Frame")
    logoFrame.Name = "Logo"
    logoFrame.Parent = titleBar
    logoFrame.Size = UDim2.new(0, 30, 0, 30)
    logoFrame.Position = UDim2.new(0, 10, 0.5, -15)
    logoFrame.BackgroundColor3 = colors.accent
    logoFrame.BorderSizePixel = 0
    logoFrame.ZIndex = 4
    
    local logoCorner = Instance.new("UICorner")
    logoCorner.CornerRadius = UDim.new(0, 6)
    logoCorner.Parent = logoFrame
    
    local logoText = Instance.new("TextLabel")
    logoText.Parent = logoFrame
    logoText.Size = UDim2.new(1, 0, 1, 0)
    logoText.BackgroundTransparency = 1
    logoText.Text = "V"
    logoText.TextColor3 = colors.text
    logoText.TextSize = 16
    logoText.Font = Enum.Font.GothamBold
    logoText.ZIndex = 5
    
    -- Title
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Name = "Title"
    titleLabel.Parent = titleBar
    titleLabel.Size = UDim2.new(1, -150, 1, 0)
    titleLabel.Position = UDim2.new(0, 50, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title or "vClothes UI v2.0"
    titleLabel.TextColor3 = colors.text
    titleLabel.TextSize = 16
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.ZIndex = 4
    
    -- Control Buttons Container
    local controlsFrame = Instance.new("Frame")
    controlsFrame.Parent = titleBar
    controlsFrame.Size = UDim2.new(0, 80, 0, 30)
    controlsFrame.Position = UDim2.new(1, -90, 0.5, -15)
    controlsFrame.BackgroundTransparency = 1
    controlsFrame.ZIndex = 4
    
    -- Minimize Button
    local minimizeBtn = Instance.new("TextButton")
    minimizeBtn.Name = "MinimizeButton"
    minimizeBtn.Parent = controlsFrame
    minimizeBtn.Size = UDim2.new(0, 35, 0, 25)
    minimizeBtn.Position = UDim2.new(0, 0, 0.5, -12.5)
    minimizeBtn.BackgroundColor3 = colors.warning
    minimizeBtn.BorderSizePixel = 0
    minimizeBtn.Text = "−"
    minimizeBtn.TextColor3 = colors.text
    minimizeBtn.TextSize = 16
    minimizeBtn.Font = Enum.Font.GothamBold
    minimizeBtn.ZIndex = 5
    
    local minimizeBtnCorner = Instance.new("UICorner")
    minimizeBtnCorner.CornerRadius = UDim.new(0, 4)
    minimizeBtnCorner.Parent = minimizeBtn
    
    -- Close Button
    local closeBtn = Instance.new("TextButton")
    closeBtn.Name = "CloseButton"
    closeBtn.Parent = controlsFrame
    closeBtn.Size = UDim2.new(0, 35, 0, 25)
    closeBtn.Position = UDim2.new(0, 40, 0.5, -12.5)
    closeBtn.BackgroundColor3 = colors.error
    closeBtn.BorderSizePixel = 0
    closeBtn.Text = "×"
    closeBtn.TextColor3 = colors.text
    closeBtn.TextSize = 18
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.ZIndex = 5
    
    local closeBtnCorner = Instance.new("UICorner")
    closeBtnCorner.CornerRadius = UDim.new(0, 4)
    closeBtnCorner.Parent = closeBtn
    
    -- Enhanced Sidebar
    local sidebar = Instance.new("Frame")
    sidebar.Name = "Sidebar"
    sidebar.Parent = mainFrame
    sidebar.Size = UDim2.new(0, 160, 1, -40)
    sidebar.Position = UDim2.new(0, 0, 0, 40)
    sidebar.BackgroundColor3 = colors.sidebar
    sidebar.BorderSizePixel = 0
    sidebar.ZIndex = 3
    
    local sidebarCorner = Instance.new("UICorner")
    sidebarCorner.CornerRadius = UDim.new(0, 10)
    sidebarCorner.Parent = sidebar
    
    local sidebarFix = Instance.new("Frame")
    sidebarFix.Parent = sidebar
    sidebarFix.Size = UDim2.new(0, 10, 1, 0)
    sidebarFix.Position = UDim2.new(1, -10, 0, 0)
    sidebarFix.BackgroundColor3 = colors.sidebar
    sidebarFix.BorderSizePixel = 0
    sidebarFix.ZIndex = 3
    
    local sidebarFix2 = Instance.new("Frame")
    sidebarFix2.Parent = sidebar
    sidebarFix2.Size = UDim2.new(1, 0, 0, 10)
    sidebarFix2.Position = UDim2.new(0, 0, 0, 0)
    sidebarFix2.BackgroundColor3 = colors.sidebar
    sidebarFix2.BorderSizePixel = 0
    sidebarFix2.ZIndex = 3
    
    -- Tab List
    local tabList = Instance.new("ScrollingFrame")
    tabList.Name = "TabList"
    tabList.Parent = sidebar
    tabList.Size = UDim2.new(1, -12, 1, -15)
    tabList.Position = UDim2.new(0, 6, 0, 10)
    tabList.BackgroundTransparency = 1
    tabList.BorderSizePixel = 0
    tabList.ScrollBarThickness = 3
    tabList.ScrollBarImageColor3 = colors.accent
    tabList.CanvasSize = UDim2.new(0, 0, 0, 0)
    tabList.ZIndex = 4
    
    local tabListLayout = Instance.new("UIListLayout")
    tabListLayout.Parent = tabList
    tabListLayout.FillDirection = Enum.FillDirection.Vertical
    tabListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    tabListLayout.Padding = UDim.new(0, 6)
    
    -- Content Area
    local contentArea = Instance.new("Frame")
    contentArea.Name = "ContentArea"
    contentArea.Parent = mainFrame
    contentArea.Size = UDim2.new(1, -170, 1, -50)
    contentArea.Position = UDim2.new(0, 165, 0, 45)
    contentArea.BackgroundTransparency = 1
    contentArea.BorderSizePixel = 0
    contentArea.ZIndex = 3
    
    window.screenGui = screenGui
    window.mainFrame = mainFrame
    window.shadowFrame = shadowFrame
    window.sidebar = sidebar
    window.tabList = tabList
    window.contentArea = contentArea
    
    -- Minimize/Restore functionality
    local originalSize = mainFrame.Size
    local originalShadowSize = shadowFrame.Size
    local minimizedSize = UDim2.new(0, 560, 0, 40)
    local minimizedShadowSize = UDim2.new(0, 570, 0, 50)
    
    minimizeBtn.MouseButton1Click:Connect(function()
        window.minimized = not window.minimized
        
        if window.minimized then
            minimizeBtn.Text = "□"
            TweenService:Create(mainFrame, tweenInfo, {Size = minimizedSize}):Play()
            TweenService:Create(shadowFrame, tweenInfo, {Size = minimizedShadowSize}):Play()
            
            sidebar.Visible = false
            contentArea.Visible = false
        else
            minimizeBtn.Text = "−"
            TweenService:Create(mainFrame, tweenInfo, {Size = originalSize}):Play()
            TweenService:Create(shadowFrame, tweenInfo, {Size = originalShadowSize}):Play()
            
            wait(0.2)
            sidebar.Visible = true
            contentArea.Visible = true
        end
    end)
    
    closeBtn.MouseButton1Click:Connect(function()
        TweenService:Create(mainFrame, tweenInfo, {Size = UDim2.new(0, 0, 0, 0)}):Play()
        TweenService:Create(shadowFrame, tweenInfo, {Size = UDim2.new(0, 0, 0, 0), BackgroundTransparency = 1}):Play()
        wait(0.4)
        screenGui:Destroy()
    end)
    
    -- Hover effects for buttons
    for _, btn in pairs({minimizeBtn, closeBtn}) do
        btn.MouseEnter:Connect(function()
            TweenService:Create(btn, fastTween, {Size = UDim2.new(0, 37, 0, 27)}):Play()
        end)
        
        btn.MouseLeave:Connect(function()
            TweenService:Create(btn, fastTween, {Size = UDim2.new(0, 35, 0, 25)}):Play()
        end)
    end
    
    -- Tạo Tab với enhanced design
    function window:CreateTab(name, icon)
        local tab = {}
        tab.name = name
        tab.elements = {}
        tab.toggleBoxes = {}
        
        -- Tab Button với enhanced design
        local tabBtn = Instance.new("TextButton")
        tabBtn.Name = name .. "Tab"
        tabBtn.Parent = tabList
        tabBtn.Size = UDim2.new(1, 0, 0, 45)
        tabBtn.BackgroundColor3 = colors.hover
        tabBtn.BackgroundTransparency = 1
        tabBtn.BorderSizePixel = 0
        tabBtn.Text = ""
        tabBtn.ZIndex = 5
        
        local tabBtnCorner = Instance.new("UICorner")
        tabBtnCorner.CornerRadius = UDim.new(0, 8)
        tabBtnCorner.Parent = tabBtn
        
        -- Tab Icon
        local tabIcon = Instance.new("TextLabel")
        tabIcon.Parent = tabBtn
        tabIcon.Size = UDim2.new(0, 20, 0, 20)
        tabIcon.Position = UDim2.new(0, 15, 0.5, -10)
        tabIcon.BackgroundTransparency = 1
        tabIcon.Text = icon or "●"
        tabIcon.TextColor3 = colors.textDim
        tabIcon.TextSize = 16
        tabIcon.Font = Enum.Font.Gotham
        tabIcon.ZIndex = 6
        
        -- Tab Label
        local tabLabel = Instance.new("TextLabel")
        tabLabel.Parent = tabBtn
        tabLabel.Size = UDim2.new(1, -50, 1, 0)
        tabLabel.Position = UDim2.new(0, 45, 0, 0)
        tabLabel.BackgroundTransparency = 1
        tabLabel.Text = name
        tabLabel.TextColor3 = colors.textDim
        tabLabel.TextSize = 14
        tabLabel.Font = Enum.Font.Gotham
        tabLabel.TextXAlignment = Enum.TextXAlignment.Left
        tabLabel.TextTruncate = Enum.TextTruncate.AtEnd
        tabLabel.ZIndex = 6
        
        -- Active Indicator
        local activeIndicator = Instance.new("Frame")
        activeIndicator.Parent = tabBtn
        activeIndicator.Size = UDim2.new(0, 3, 0, 0)
        activeIndicator.Position = UDim2.new(0, 0, 0.5, 0)
        activeIndicator.BackgroundColor3 = colors.accent
        activeIndicator.BorderSizePixel = 0
        activeIndicator.ZIndex = 6
        
        local indicatorCorner = Instance.new("UICorner")
        indicatorCorner.CornerRadius = UDim.new(0, 2)
        indicatorCorner.Parent = activeIndicator
        
        -- Tab Content
        local tabContent = Instance.new("ScrollingFrame")
        tabContent.Name = name .. "Content"
        tabContent.Parent = contentArea
        tabContent.Size = UDim2.new(1, 0, 1, 0)
        tabContent.BackgroundTransparency = 1
        tabContent.BorderSizePixel = 0
        tabContent.ScrollBarThickness = 3
        tabContent.ScrollBarImageColor3 = colors.accent
        tabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
        tabContent.Visible = false
        tabContent.ZIndex = 4
        
        local contentLayout = Instance.new("UIListLayout")
        contentLayout.Parent = tabContent
        contentLayout.FillDirection = Enum.FillDirection.Vertical
        contentLayout.SortOrder = Enum.SortOrder.LayoutOrder
        contentLayout.Padding = UDim.new(0, 10)
        
        local contentPadding = Instance.new("UIPadding")
        contentPadding.PaddingTop = UDim.new(0, 15)
        contentPadding.PaddingBottom = UDim.new(0, 15)
        contentPadding.PaddingLeft = UDim.new(0, 15)
        contentPadding.PaddingRight = UDim.new(0, 15)
        contentPadding.Parent = tabContent
        
        tab.button = tabBtn
        tab.content = tabContent
        tab.layout = contentLayout
        tab.icon = tabIcon
        tab.label = tabLabel
        tab.indicator = activeIndicator
        
        -- Tab Click Event
        tabBtn.MouseButton1Click:Connect(function()
            window:SelectTab(tab)
        end)
        
        -- Enhanced Hover Effects
        tabBtn.MouseEnter:Connect(function()
            if window.activeTab ~= tab then
                TweenService:Create(tabBtn, fastTween, {BackgroundTransparency = 0, BackgroundColor3 = colors.hover}):Play()
                TweenService:Create(tabIcon, fastTween, {TextColor3 = colors.textSecondary}):Play()
                TweenService:Create(tabLabel, fastTween, {TextColor3 = colors.textSecondary}):Play()
            end
        end)
        
        tabBtn.MouseLeave:Connect(function()
            if window.activeTab ~= tab then
                TweenService:Create(tabBtn, fastTween, {BackgroundTransparency = 1}):Play()
                TweenService:Create(tabIcon, fastTween, {TextColor3 = colors.textDim}):Play()
                TweenService:Create(tabLabel, fastTween, {TextColor3 = colors.textDim}):Play()
            end
        end)
        
        -- Update canvas size
        contentLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            tabContent.CanvasSize = UDim2.new(0, 0, 0, contentLayout.AbsoluteContentSize.Y + 30)
        end)
        
        window.tabs[#window.tabs + 1] = tab
        
        if #window.tabs == 1 then
            window:SelectTab(tab)
        end
        
        tabListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            tabList.CanvasSize = UDim2.new(0, 0, 0, tabListLayout.AbsoluteContentSize.Y + 20)
        end)
        
        -- Enhanced Button
        function tab:CreateButton(text, callback)
            local btn = Instance.new("TextButton")
            btn.Name = text .. "Button"
            btn.Parent = tabContent
            btn.Size = UDim2.new(1, 0, 0, 40)
            btn.BackgroundColor3 = colors.accent
            btn.BorderSizePixel = 0
            btn.Text = text
            btn.TextColor3 = colors.text
            btn.TextSize = 14
            btn.Font = Enum.Font.GothamMedium
            btn.ZIndex = 5
            
            local btnCorner = Instance.new("UICorner")
            btnCorner.CornerRadius = UDim.new(0, 8)
            btnCorner.Parent = btn
            
            -- Gradient
            local btnGradient = Instance.new("UIGradient")
            btnGradient.Color = ColorSequence.new({
                ColorSequenceKeypoint.new(0, colors.accent),
                ColorSequenceKeypoint.new(1, colors.accentHover)
            })
            btnGradient.Rotation = 45
            btnGradient.Parent = btn
            
            btn.MouseButton1Click:Connect(function()
                TweenService:Create(btn, TweenInfo.new(0.1), {Size = UDim2.new(1, -4, 0, 36)}):Play()
                wait(0.1)
                TweenService:Create(btn, TweenInfo.new(0.1), {Size = UDim2.new(1, 0, 0, 40)}):Play()
                if callback then callback() end
            end)
            
            btn.MouseEnter:Connect(function()
                TweenService:Create(btnGradient, fastTween, {Rotation = 90}):Play()
            end)
            
            btn.MouseLeave:Connect(function()
                TweenService:Create(btnGradient, fastTween, {Rotation = 45}):Play()
            end)
            
            return btn
        end
        
        -- Enhanced Toggle
        function tab:CreateToggle(text, defaultValue, callback)
            local toggleFrame = Instance.new("Frame")
            toggleFrame.Name = text .. "Toggle"
            toggleFrame.Parent = tabContent
            toggleFrame.Size = UDim2.new(1, 0, 0, 40)
            toggleFrame.BackgroundColor3 = colors.backgroundSecondary
            toggleFrame.BorderSizePixel = 0
            toggleFrame.ZIndex = 5
            
            local toggleCorner = Instance.new("UICorner")
            toggleCorner.CornerRadius = UDim.new(0, 8)
            toggleCorner.Parent = toggleFrame
            
            local toggleLabel = Instance.new("TextLabel")
            toggleLabel.Parent = toggleFrame
            toggleLabel.Size = UDim2.new(1, -60, 1, 0)
            toggleLabel.Position = UDim2.new(0, 15, 0, 0)
            toggleLabel.BackgroundTransparency = 1
            toggleLabel.Text = text
            toggleLabel.TextColor3 = colors.text
            toggleLabel.TextSize = 14
            toggleLabel.Font = Enum.Font.GothamMedium
            toggleLabel.TextXAlignment = Enum.TextXAlignment.Left
            toggleLabel.ZIndex = 6
            
            local toggleBtn = Instance.new("TextButton")
            toggleBtn.Parent = toggleFrame
            toggleBtn.Size = UDim2.new(0, 40, 0, 20)
            toggleBtn.Position = UDim2.new(1, -50, 0.5, -10)
            toggleBtn.BackgroundColor3 = defaultValue and colors.accent or colors.border
            toggleBtn.BorderSizePixel = 0
            toggleBtn.Text = ""
            toggleBtn.ZIndex = 6
            
            local toggleBtnCorner = Instance.new("UICorner")
            toggleBtnCorner.CornerRadius = UDim.new(0, 10)
            toggleBtnCorner.Parent = toggleBtn
            
            local toggleIndicator = Instance.new("Frame")
            toggleIndicator.Parent = toggleBtn
            toggleIndicator.Size = UDim2.new(0, 16, 0, 16)
            toggleIndicator.Position = defaultValue and UDim2.new(0, 22, 0.5, -8) or UDim2.new(0, 2, 0.5, -8)
            toggleIndicator.BackgroundColor3 = colors.text
            toggleIndicator.BorderSizePixel = 0
            toggleIndicator.ZIndex = 7
            
            local indicatorCorner = Instance.new("UICorner")
            indicatorCorner.CornerRadius = UDim.new(0, 8)
            indicatorCorner.Parent = toggleIndicator
            
            local toggled = defaultValue or false
            
            toggleBtn.MouseButton1Click:Connect(function()
                toggled = not toggled
                
                local btnColor = toggled and colors.accent or colors.border
                local indicatorPos = toggled and UDim2.new(0, 22, 0.5, -8) or UDim2.new(0, 2, 0.5, -8)
                
                TweenService:Create(toggleBtn, tweenInfo, {BackgroundColor3 = btnColor}):Play()
                TweenService:Create(toggleIndicator, tweenInfo, {Position = indicatorPos}):Play()
                
                if callback then callback(toggled) end
            end)
            
            return toggleFrame
        end
        
        -- Enhanced Input
        function tab:CreateInput(text, placeholder, callback)
            local inputFrame = Instance.new("Frame")
            inputFrame.Name = text .. "Input"
            inputFrame.Parent = tabContent
            inputFrame.Size = UDim2.new(1, 0, 0, 70)
            inputFrame.BackgroundTransparency = 1
            inputFrame.BorderSizePixel = 0
            inputFrame.ZIndex = 5
            
            local inputLabel = Instance.new("TextLabel")
            inputLabel.Parent = inputFrame
            inputLabel.Size = UDim2.new(1, 0, 0, 25)
            inputLabel.BackgroundTransparency = 1
            inputLabel.Text = text
            inputLabel.TextColor3 = colors.text
            inputLabel.TextSize = 14
            inputLabel.Font = Enum.Font.GothamMedium
            inputLabel.TextXAlignment = Enum.TextXAlignment.Left
            inputLabel.ZIndex = 6
            
            local inputBox = Instance.new("TextBox")
            inputBox.Parent = inputFrame
            inputBox.Size = UDim2.new(1, 0, 0, 40)
            inputBox.Position = UDim2.new(0, 0, 0, 30)
            inputBox.BackgroundColor3 = colors.backgroundSecondary
            inputBox.BorderSizePixel = 0
            inputBox.PlaceholderText = placeholder or ""
            inputBox.Text = ""
            inputBox.TextColor3 = colors.text
            inputBox.PlaceholderColor3 = colors.textDim
            inputBox.TextSize = 14
            inputBox.Font = Enum.Font.Gotham
            inputBox.ClearTextOnFocus = false
            inputBox.ZIndex = 6
            
            local inputCorner = Instance.new("UICorner")
            inputCorner.CornerRadius = UDim.new(0, 8)
            inputCorner.Parent = inputBox
            
            local inputPadding = Instance.new("UIPadding")
            inputPadding.PaddingLeft = UDim.new(0, 15)
            inputPadding.PaddingRight = UDim.new(0, 15)
            inputPadding.Parent = inputBox
            
            -- Focus effects
            inputBox.Focused:Connect(function()
                TweenService:Create(inputBox, fastTween, {BackgroundColor3 = colors.hover}):Play()
            end)
            
            inputBox.FocusLost:Connect(function(enterPressed)
                TweenService:Create(inputBox, fastTween, {BackgroundColor3 = colors.backgroundSecondary}):Play()
                if callback then callback(inputBox.Text, enterPressed) end
            end)
            
            return inputBox
        end
        
        -- Enhanced Toggle Box Container với Auto Layout
        function tab:CreateToggleBoxContainer()
            local containerFrame = Instance.new("Frame")
            containerFrame.Name = "ToggleBoxContainer"
            containerFrame.Parent = tabContent
            containerFrame.Size = UDim2.new(1, 0, 0, 50)
            containerFrame.BackgroundTransparency = 1
            containerFrame.BorderSizePixel = 0
            containerFrame.ZIndex = 5
            
            local containerLayout = Instance.new("UIGridLayout")
            containerLayout.Parent = containerFrame
            containerLayout.CellSize = UDim2.new(0, 115, 0, 40)
            containerLayout.CellPadding = UDim2.new(0, 8, 0, 8)
            containerLayout.SortOrder = Enum.SortOrder.LayoutOrder
            containerLayout.FillDirection = Enum.FillDirection.Horizontal
            containerLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
            containerLayout.VerticalAlignment = Enum.VerticalAlignment.Top
            
            local toggleBoxes = {}
            
            -- Update container size based on content
            local function updateContainerSize()
                local totalBoxes = #toggleBoxes
                local rows = math.ceil(totalBoxes / 3)
                local newHeight = math.max(50, rows * 48) -- 40 + 8 padding
                containerFrame.Size = UDim2.new(1, 0, 0, newHeight)
            end
            
            local container = {
                frame = containerFrame,
                layout = containerLayout,
                boxes = toggleBoxes,
                updateSize = updateContainerSize
            }
            
            window.toggleBoxContainers[#window.toggleBoxContainers + 1] = container
            return container
        end
        
        -- Enhanced Toggle Box với Auto-arrangement
        function tab:CreateToggleBox(text, defaultValue, callback, container)
            if not container then
                container = tab:CreateToggleBoxContainer()
            end
            
            local boxBtn = Instance.new("TextButton")
            boxBtn.Name = text .. "ToggleBox"
            boxBtn.Parent = container.frame
            boxBtn.Size = UDim2.new(0, 115, 0, 40)
            boxBtn.BackgroundColor3 = defaultValue and colors.accent or colors.backgroundSecondary
            boxBtn.BorderSizePixel = 0
            boxBtn.Text = text
            boxBtn.TextColor3 = colors.text
            boxBtn.TextSize = 12
            boxBtn.Font = Enum.Font.GothamMedium
            boxBtn.TextWrapped = true
            boxBtn.ZIndex = 6
            
            local boxCorner = Instance.new("UICorner")
            boxCorner.CornerRadius = UDim.new(0, 8)
            boxCorner.Parent = boxBtn
            
            -- Glow effect khi active
            local glowFrame = Instance.new("Frame")
            glowFrame.Parent = boxBtn
            glowFrame.Size = UDim2.new(1, 4, 1, 4)
            glowFrame.Position = UDim2.new(0, -2, 0, -2)
            glowFrame.BackgroundColor3 = colors.accent
            glowFrame.BackgroundTransparency = defaultValue and 0.7 or 1
            glowFrame.BorderSizePixel = 0
            glowFrame.ZIndex = 5
            
            local glowCorner = Instance.new("UICorner")
            glowCorner.CornerRadius = UDim.new(0, 10)
            glowCorner.Parent = glowFrame
            
            local toggled = defaultValue or false
            
            boxBtn.MouseButton1Click:Connect(function()
                toggled = not toggled
                
                local btnColor = toggled and colors.accent or colors.backgroundSecondary
                local glowTransparency = toggled and 0.7 or 1
                
                TweenService:Create(boxBtn, tweenInfo, {BackgroundColor3 = btnColor}):Play()
                TweenService:Create(glowFrame, tweenInfo, {BackgroundTransparency = glowTransparency}):Play()
                
                if toggled then
                    TweenService:Create(boxBtn, TweenInfo.new(0.1), {Size = UDim2.new(0, 118, 0, 43)}):Play()
                    wait(0.1)
                    TweenService:Create(boxBtn, TweenInfo.new(0.1), {Size = UDim2.new(0, 115, 0, 40)}):Play()
                end
                
                if callback then callback(toggled) end
            end)
            
            -- Hover effect
            boxBtn.MouseEnter:Connect(function()
                if not toggled then
                    TweenService:Create(boxBtn, fastTween, {BackgroundColor3 = colors.hover}):Play()
                end
            end)
            
            boxBtn.MouseLeave:Connect(function()
                if not toggled then
                    TweenService:Create(boxBtn, fastTween, {BackgroundColor3 = colors.backgroundSecondary}):Play()
                end
            end)
            
            container.boxes[#container.boxes + 1] = boxBtn
            container.updateSize()
            
            return boxBtn
        end
        
        -- Enhanced Button Switch (Full Width)
        function tab:CreateButtonSwitch(text, options, defaultIndex, callback)
            local switchFrame = Instance.new("Frame")
            switchFrame.Name = text .. "Switch"
            switchFrame.Parent = tabContent
            switchFrame.Size = UDim2.new(1, 0, 0, 70)
            switchFrame.BackgroundTransparency = 1
            switchFrame.BorderSizePixel = 0
            switchFrame.ZIndex = 5
            
            local switchLabel = Instance.new("TextLabel")
            switchLabel.Parent = switchFrame
            switchLabel.Size = UDim2.new(1, 0, 0, 25)
            switchLabel.BackgroundTransparency = 1
            switchLabel.Text = text
            switchLabel.TextColor3 = colors.text
            switchLabel.TextSize = 14
            switchLabel.Font = Enum.Font.GothamMedium
            switchLabel.TextXAlignment = Enum.TextXAlignment.Left
            switchLabel.ZIndex = 6
            
            local switchBtn = Instance.new("TextButton")
            switchBtn.Parent = switchFrame
            switchBtn.Size = UDim2.new(1, 0, 0, 40)
            switchBtn.Position = UDim2.new(0, 0, 0, 30)
            switchBtn.BackgroundColor3 = colors.accent
            switchBtn.BorderSizePixel = 0
            switchBtn.TextColor3 = colors.text
            switchBtn.TextSize = 14
            switchBtn.Font = Enum.Font.GothamMedium
            switchBtn.ZIndex = 6
            
            local switchCorner = Instance.new("UICorner")
            switchCorner.CornerRadius = UDim.new(0, 8)
            switchCorner.Parent = switchBtn
            
            -- Gradient effect
            local switchGradient = Instance.new("UIGradient")
            switchGradient.Color = ColorSequence.new({
                ColorSequenceKeypoint.new(0, colors.accent),
                ColorSequenceKeypoint.new(1, colors.accentHover)
            })
            switchGradient.Rotation = 45
            switchGradient.Parent = switchBtn
            
            -- Value indicator
            local valueFrame = Instance.new("Frame")
            valueFrame.Parent = switchBtn
            valueFrame.Size = UDim2.new(0, 30, 0, 30)
            valueFrame.Position = UDim2.new(1, -35, 0.5, -15)
            valueFrame.BackgroundColor3 = colors.backgroundSecondary
            valueFrame.BorderSizePixel = 0
            valueFrame.ZIndex = 7
            
            local valueCorner = Instance.new("UICorner")
            valueCorner.CornerRadius = UDim.new(0, 6)
            valueCorner.Parent = valueFrame
            
            local valueLabel = Instance.new("TextLabel")
            valueLabel.Parent = valueFrame
            valueLabel.Size = UDim2.new(1, 0, 1, 0)
            valueLabel.BackgroundTransparency = 1
            valueLabel.TextColor3 = colors.text
            valueLabel.TextSize = 12
            valueLabel.Font = Enum.Font.GothamBold
            valueLabel.ZIndex = 8
            
            local currentIndex = defaultIndex or 1
            local function updateDisplay()
                local currentValue = tostring(options[currentIndex])
                switchBtn.Text = text .. ": " .. currentValue
                valueLabel.Text = tostring(currentIndex)
            end
            
            updateDisplay()
            
            switchBtn.MouseButton1Click:Connect(function()
                currentIndex = currentIndex + 1
                if currentIndex > #options then
                    currentIndex = 1
                end
                
                updateDisplay()
                
                -- Animation
                TweenService:Create(valueFrame, TweenInfo.new(0.1), {Size = UDim2.new(0, 35, 0, 35)}):Play()
                TweenService:Create(switchGradient, fastTween, {Rotation = switchGradient.Rotation + 45}):Play()
                wait(0.1)
                TweenService:Create(valueFrame, TweenInfo.new(0.1), {Size = UDim2.new(0, 30, 0, 30)}):Play()
                
                if callback then callback(options[currentIndex], currentIndex) end
            end)
            
            -- Hover effects
            switchBtn.MouseEnter:Connect(function()
                TweenService:Create(switchGradient, fastTween, {Rotation = 90}):Play()
                TweenService:Create(valueFrame, fastTween, {BackgroundColor3 = colors.hover}):Play()
            end)
            
            switchBtn.MouseLeave:Connect(function()
                TweenService:Create(switchGradient, fastTween, {Rotation = 45}):Play()
                TweenService:Create(valueFrame, fastTween, {BackgroundColor3 = colors.backgroundSecondary}):Play()
            end)
            
            return switchBtn
        end
        
        -- Slider Component (Bonus)
        function tab:CreateSlider(text, min, max, defaultValue, callback)
            local sliderFrame = Instance.new("Frame")
            sliderFrame.Name = text .. "Slider"
            sliderFrame.Parent = tabContent
            sliderFrame.Size = UDim2.new(1, 0, 0, 70)
            sliderFrame.BackgroundTransparency = 1
            sliderFrame.BorderSizePixel = 0
            sliderFrame.ZIndex = 5
            
            local sliderLabel = Instance.new("TextLabel")
            sliderLabel.Parent = sliderFrame
            sliderLabel.Size = UDim2.new(0.7, 0, 0, 25)
            sliderLabel.BackgroundTransparency = 1
            sliderLabel.Text = text
            sliderLabel.TextColor3 = colors.text
            sliderLabel.TextSize = 14
            sliderLabel.Font = Enum.Font.GothamMedium
            sliderLabel.TextXAlignment = Enum.TextXAlignment.Left
            sliderLabel.ZIndex = 6
            
            local valueLabel = Instance.new("TextLabel")
            valueLabel.Parent = sliderFrame
            valueLabel.Size = UDim2.new(0.3, 0, 0, 25)
            valueLabel.Position = UDim2.new(0.7, 0, 0, 0)
            valueLabel.BackgroundTransparency = 1
            valueLabel.Text = tostring(defaultValue or min)
            valueLabel.TextColor3 = colors.accent
            valueLabel.TextSize = 14
            valueLabel.Font = Enum.Font.GothamBold
            valueLabel.TextXAlignment = Enum.TextXAlignment.Right
            valueLabel.ZIndex = 6
            
            local sliderTrack = Instance.new("Frame")
            sliderTrack.Parent = sliderFrame
            sliderTrack.Size = UDim2.new(1, 0, 0, 6)
            sliderTrack.Position = UDim2.new(0, 0, 0, 45)
            sliderTrack.BackgroundColor3 = colors.backgroundSecondary
            sliderTrack.BorderSizePixel = 0
            sliderTrack.ZIndex = 6
            
            local trackCorner = Instance.new("UICorner")
            trackCorner.CornerRadius = UDim.new(0, 3)
            trackCorner.Parent = sliderTrack
            
            local sliderFill = Instance.new("Frame")
            sliderFill.Parent = sliderTrack
            sliderFill.Size = UDim2.new((defaultValue or min) / max, 0, 1, 0)
            sliderFill.BackgroundColor3 = colors.accent
            sliderFill.BorderSizePixel = 0
            sliderFill.ZIndex = 7
            
            local fillCorner = Instance.new("UICorner")
            fillCorner.CornerRadius = UDim.new(0, 3)
            fillCorner.Parent = sliderFill
            
            local sliderButton = Instance.new("TextButton")
            sliderButton.Parent = sliderFrame
            sliderButton.Size = UDim2.new(0, 20, 0, 20)
            sliderButton.Position = UDim2.new((defaultValue or min) / max, -10, 0, 38)
            sliderButton.BackgroundColor3 = colors.text
            sliderButton.BorderSizePixel = 0
            sliderButton.Text = ""
            sliderButton.ZIndex = 8
            
            local buttonCorner = Instance.new("UICorner")
            buttonCorner.CornerRadius = UDim.new(0, 10)
            buttonCorner.Parent = sliderButton
            
            local currentValue = defaultValue or min
            local dragging = false
            
            local function updateSlider(value)
                currentValue = math.clamp(value, min, max)
                local percentage = (currentValue - min) / (max - min)
                
                valueLabel.Text = tostring(math.floor(currentValue * 100) / 100)
                sliderFill.Size = UDim2.new(percentage, 0, 1, 0)
                sliderButton.Position = UDim2.new(percentage, -10, 0, 38)
                
                if callback then callback(currentValue) end
            end
            
            sliderButton.MouseButton1Down:Connect(function()
                dragging = true
            end)
            
            UserInputService.InputEnded:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = false
                end
            end)
            
            UserInputService.InputChanged:Connect(function(input)
                if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                    local mousePos = input.Position.X
                    local framePos = sliderTrack.AbsolutePosition.X
                    local frameSize = sliderTrack.AbsoluteSize.X
                    local percentage = math.clamp((mousePos - framePos) / frameSize, 0, 1)
                    local value = min + (max - min) * percentage
                    updateSlider(value)
                end
            end)
            
            sliderTrack.InputBegan:Connect(function(input)
                if input.UserInputType == Enum.UserInputType.MouseButton1 then
                    local mousePos = input.Position.X
                    local framePos = sliderTrack.AbsolutePosition.X
                    local frameSize = sliderTrack.AbsoluteSize.X
                    local percentage = math.clamp((mousePos - framePos) / frameSize, 0, 1)
                    local value = min + (max - min) * percentage
                    updateSlider(value)
                end
            end)
            
            return sliderFrame
        end
        
        return tab
    end
    
    -- Enhanced Select Tab Function
    function window:SelectTab(tab)
        for _, t in pairs(self.tabs) do
            t.content.Visible = false
            TweenService:Create(t.button, fastTween, {BackgroundTransparency = 1}):Play()
            TweenService:Create(t.icon, fastTween, {TextColor3 = colors.textDim}):Play()
            TweenService:Create(t.label, fastTween, {TextColor3 = colors.textDim}):Play()
            TweenService:Create(t.indicator, fastTween, {Size = UDim2.new(0, 3, 0, 0)}):Play()
        end
        
        tab.content.Visible = true
        TweenService:Create(tab.button, fastTween, {BackgroundColor3 = colors.hover, BackgroundTransparency = 0}):Play()
        TweenService:Create(tab.icon, fastTween, {TextColor3 = colors.accent}):Play()
        TweenService:Create(tab.label, fastTween, {TextColor3 = colors.text}):Play()
        TweenService:Create(tab.indicator, fastTween, {Size = UDim2.new(0, 3, 0, 30)}):Play()
        
        self.activeTab = tab
    end
    
    -- Toggle Visibility Function
    function window:Toggle()
        if mainFrame.Visible then
            TweenService:Create(mainFrame, tweenInfo, {Position = UDim2.new(0.5, -280, 0.5, -250)}):Play()
            TweenService:Create(shadowFrame, tweenInfo, {Position = UDim2.new(0.5, -285, 0.5, -255)}):Play()
            wait(0.2)
            mainFrame.Visible = false
            shadowFrame.Visible = false
        else
            mainFrame.Visible = true
            shadowFrame.Visible = true
            TweenService:Create(mainFrame, tweenInfo, {Position = UDim2.new(0.5, -280, 0.5, -205)}):Play()
            TweenService:Create(shadowFrame, tweenInfo, {Position = UDim2.new(0.5, -285, 0.5, -210)}):Play()
        end
    end
    
    return window
end

-- Global Toggle Key (F1)
UserInputService.InputBegan:Connect(function(key, gameProcessed)
    if not gameProcessed and key.KeyCode == Enum.KeyCode.F1 then
        for _, gui in pairs(playerGui:GetChildren()) do
            if gui.Name == "vClothesUI_v2" and gui:FindFirstChild("MainFrame") then
                local mainFrame = gui.MainFrame
                if mainFrame.Visible then
                    TweenService:Create(mainFrame, tweenInfo, {Position = UDim2.new(0.5, -280, 0.5, -250)}):Play()
                    if gui:FindFirstChild("ShadowFrame") then
                        TweenService:Create(gui.ShadowFrame, tweenInfo, {Position = UDim2.new(0.5, -285, 0.5, -255)}):Play()
                    end
                    wait(0.2)
                    mainFrame.Visible = false
                    if gui:FindFirstChild("ShadowFrame") then
                        gui.ShadowFrame.Visible = false
                    end
                else
                    mainFrame.Visible = true
                    if gui:FindFirstChild("ShadowFrame") then
                        gui.ShadowFrame.Visible = true
                    end
                    TweenService:Create(mainFrame, tweenInfo, {Position = UDim2.new(0.5, -280, 0.5, -205)}):Play()
                    if gui:FindFirstChild("ShadowFrame") then
                        TweenService:Create(gui.ShadowFrame, tweenInfo, {Position = UDim2.new(0.5, -285, 0.5, -210)}):Play()
                    end
                end
                break
            end
        end
    end
end)

return vClothesUI
